# Text Statistics

## Brief

We would like you to write a small website that calculates statistics about text files that are uploaded to it and displays those statistics in a useful form. The site can be developed in any language and can make use of any technologies you see fit.

### Required Statistics

- Whitespace delimited word count
- Line count
- Mean, mode and median letters per word (1 decimal place)
- Most common letter

## Solution description

The solution is built using JavaScript (node.js and the browser), HTML and CSS.

A web server is created using the [express](https://github.com/expressjs/express) library.
It exposes a statistics API, accessed through a POST request to the `/statistics` URL.
This API expects a single file with the field name `file`.
It will return a JSON object detailing statistics about the file.
A naive file handler implementation is used to check the extension of incoming files.
The API will only accept `.txt` files and will return a HTTP status code of `415` if the extension is not recognised.
This could be further extended to handle other file types, e.g. Word documents (`.docx`), before parsing them into a common text format.

A static `index.html` file is served by the express web server.
This page sends a request to the API using JavaScript after a file has been selected.
The JSON response is parsed and displayed to the user on the page.

### Statistics

The statistics API itself is written as a local module inside the project.

Basic usage example:

```javascript
import statistics from 'statistics'

const text = `This is
a file of text
which is four lines long
and contains fifteen words`

statistics(text)

/*
{ sanitized: 'this is\na file of text\nwhich is four lines long\nand contains fifteen words',
  lines:
   [ 'this is',
     'a file of text',
     'which is four lines long',
     'and contains fifteen words' ],
  words:
   [ 'this',
     'is',
     'a',
     'file',
     'of',
     'text',
     'which',
     'is',
     'four',
     'lines',
     'long',
     'and',
     'contains',
     'fifteen',
     'words' ],
  letters:
   [ 't', ... ],
  lineCount: 4,
  wordCount: 15,
  letterCount: 60,
  mean: 4,
  median: 4,
  mode: [ 4 ],
  commonWords: [ 'is' ],
  commonLetters: [ 'i' ] }
*/
```

The input is santized to replace everything but letters and spaces.
Additional sanitzer and text separation options can be provided.

```javascript
import statistics from 'statistics'

statistics(
  text,
  {
    // Case insensitve
    caseSensitive = false,
    // Replace everything but letters and spaces
    textSanitizer = /[^a-zA-Z\d\s:]/g,
    // Match CRLF and LF
    lineSeparator = /\r\n?|\n/,
    // Words delimited by spaces
    wordSeparator = /\s+/,
    // Every letter separated
    letterSeparator = ''
  }
);
```

### Count

Line, word and letter counts are generated by breaking down the sanitized input into arrays using regular expressions.

### Mean and Median

The `mean` and `median` functions operate on an array of numbers.

```javascript
import { mean, median } from 'statistics'

const words = ['a', 'to', 'as', 'the', 'word', 'time', 'helps']
const stringLength = (str) => (str.length)
const numberOfVowels = (str) => {
  const match = str.match(/[aeiou]/gi)
  return match === null ? 0 : match.length
}
const lengths = words.map(stringLength)
const vowels = words.map(numberOfVowels)

console.log(mean(lengths)) // 3
console.log(median(vowels)) // 1
```

### Mode

A frequency map is used to determine the modal average of an array of items.
The frequency map is implemented using a JavaScript object which has the following limitations when it comes to storing keys:

- Possibility of collisions with other object properties.
- Only able to store strings as keys.

Two functions must be given to `mode` to overcome these limitations.
Called on each item in the array, they transform each item into a key and back again.

Two helper functions - `numberMode` and `stringMode` - are provided which allow the storage of numbers and strings as keys.
The `numberMode` function casts Numbers to Strings when storing the key. When retrieved, the String is cast back to a Number.
The `stringMode` function prepends an identifier to all keys to prevent collisions. When retrieved, the identifer is removed,

The example below shows an example of how `numberMode` can be used to calculate the average number of consonants for an array of words.

```javascript
import { numberMode } from 'statistics'

const words = ['a', 'to', 'as', 'the', 'word', 'time', 'helps']
const numberOfConsonants = (str) => {
  const match = str.match(/[bcdfghjklmnpqrstvwxyz]/gi)
  return match === null ? 0 : match.length
}
const consonants = words.map(numberOfConsonants)

console.log(numberMode(consonants)) // [1, 2]
```

### Common Letters and Words

Implemented using the `stringMode` function.

## Instructions

To run a local statistics server, clone this repository and run:

```bash
yarn start
```

By default, a server will be started on `localhost` port `8080`.
