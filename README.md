# Text Statistics

## Brief

We would like you to write a small website that calculates statistics about text files that are uploaded to it and displays those statistics in a useful form. The site can be developed in any language and can make use of any technologies you see fit.

### Required Statistics

- Whitespace delimited word count
- Line count
- Mean, mode and median letters per word (1 decimal place)
- Most common letter

## Solution description

The solution is built using JavaScript (node.js and the browser), HTML and CSS.

A web server is created using the [express](https://github.com/expressjs/express) library.
It exposes a statistics API, accessed through a POST request to the `/statistics` URL.
This API expects a single file with the field name `file`.
It will return a JSON object detailing statistics about the file.
A naive file handler implementation is used to check the extension of incoming files.
The API will only accept `.txt` files and will return a HTTP status code of `415` if the extension is not recognised.
This could be further extended to handle other file types, e.g. Word documents (`.docx`), before parsing them into a common text format.

A static `index.html` file is served by the express web server.
This page sends a request to the API using JavaScript after a file has been selected.
The JSON response is parsed and displayed to the user on the page.

### Statistics

The statistics API itself is written as a local module inside the project.

Basic usage example:

```javascript
import statistics from 'statistics'

const text = `This is
a file of text
which is four lines long
and contains fifteen words`

statistics(text)

/*
{ sanitized: 'this is\na file of text\nwhich is four lines long\nand contains fifteen words',
  lines:
   [ 'this is',
     'a file of text',
     'which is four lines long',
     'and contains fifteen words' ],
  words:
   [ 'this',
     'is',
     'a',
     'file',
     'of',
     'text',
     'which',
     'is',
     'four',
     'lines',
     'long',
     'and',
     'contains',
     'fifteen',
     'words' ],
  letters:
   [ 't', ... ],
  lineCount: 4,
  wordCount: 15,
  mean: 4,
  median: 4,
  mode: [ 4 ],
  commonWords: [ 'is' ],
  commonLetters: [ 'i' ] }
*/
```

The input is santized to replace everything but letters and spaces.
Additional sanitzer and text separation options can be provided.

```javascript
import statistics from 'statistics'

statistics(
  text,
  {
    // Case insensitve
    caseSensitive = false,
    // Replace everything but letters and spaces
    textSanitizer = /[^a-zA-Z\d\s:]/g,
    // Match CRLF and LF
    lineSeparator = /\r\n?|\n/,
    // Words delimited by spaces
    wordSeparator = /\s+/,
    // Every letter separated
    letterSeparator = ''
  }
);
```

### Count

Line, word and letter counts are generated by breaking down the input into arrays using regular expressions.

### Mean

This function given an array of integers returns the mean average.

```javascript
import { mean } from 'statistics'

const numbers = [1, 2, 2, 3, 4, 4, 5]

console.log(mean(numbers)) // 3
```

### Median

This function given an array of integers returns the median average.

```javascript
import { median } from 'statistics'

const numbers = [1, 2, 2, 3, 4, 4, 5]

console.log(median(numbers)) // 3
```

### Mode

A frequency map is used to determine the modal average of a set.
The frequency map is implemented using a JavaScript object which has the following limitations when it comes to storing keys:

- Possibility of collisions with JavaScript keywords.
- Only able to store strings as keys.

Two functions must be given to `mode` to overcome these limitations.
Called on each item in the set, they transform each item into a key and back again.
The `mode` function will itself return a function with the transformations in place.
Calling the returned function on an array of items will return the items that appear most frequently.

The example below shows how to create a mode function which can handle numbers.
The numbers in the array are converted to a string to be stored in the frequency map.
When retrieved, they are converted back to a number.

```javascript
import { mode } from 'statistics'

const numbers = [1, 2, 2, 3, 4, 4, 5]

const numToStr = (num) => (String(num))
const strToNum = (str) => (Number(str))
const numberMode = mode(numToStr, strToNum)

console.log(numberMode(numbers)) // [2, 4]
```

This allows us to work with arrays of any type.
We can even work on properties of the items of the array.
For example, given an array of words, here's how we could find the modal average of their length.

```javascript
import { mode } from 'statistics'

const words = ['one', 'two', 'three', 'four']

const wordToLength = (word) => (word.length) // Stored in the frequency map as a string
const lengthToNumber = (length) => (Number(length)) // Retrieved from the frequency map as a number
const lengthMode = mode(wordToLength, lengthToNumber)

console.log(lengthMode(numbers)) // [3]

```

### Common Letters and Words

Implemented using the `mode` function which operates on an array of letters or words.

## Instructions

To run a local statistics server, clone this repository and run:

```bash
yarn start
```

By default, a server will be started on `localhost` port `8080`.
